<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doodle World Type Coverage</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #121212;
            --bg-secondary: #222;
            --bg-tertiary: #333;
            --text-primary: #fff;
            --text-secondary: #ccc;
            --accent-primary: #4CAF50;
            --accent-secondary: #45a049;
            --border-color: #444;
            --danger: #ff4444;
            --warning: #ffeb3b;
            --success: #4CAF50;
            --card-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
            --transition: all 0.3s ease;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Fredoka', Arial, sans-serif;
            text-align: center;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            padding: 20px;
            line-height: 1.6;
            max-width: 1300px;
            margin: 0 auto;
        }

        h1, h2, h3 {
            color: var(--text-primary);
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .header-container {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: var(--card-shadow);
            border-left: 4px solid var(--accent-primary);
        }

        .mode-toggle {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .mode-toggle button {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
            font-family: 'Fredoka', sans-serif;
            font-weight: 600;
            font-size: 16px;
        }

        .mode-toggle button.active {
            background-color: var(--accent-primary);
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        .mode-toggle button:hover:not(.active) {
            background-color: #555;
            transform: translateY(-2px);
        }

        .teambuilder-link {
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(76, 175, 80, 0.1);
            border-radius: 8px;
            display: inline-block;
        }

        .teambuilder-link a {
            color: var(--accent-primary);
            text-decoration: none;
            font-weight: bold;
            transition: var(--transition);
        }

        .teambuilder-link a:hover {
            text-decoration: underline;
            color: var(--accent-secondary);
        }

        .team-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .doodle-box {
            border: 2px solid var(--border-color);
            padding: 20px;
            background: linear-gradient(145deg, var(--bg-secondary), #2a2a2a);
            text-align: left;
            border-radius: 12px;
            position: relative;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }

        .doodle-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.5);
        }

        .doodle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .remove-doodle {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .remove-doodle:hover {
            background: var(--danger);
            transform: rotate(90deg);
        }

        .add-doodle {
            background: linear-gradient(to right, var(--accent-primary), var(--accent-secondary));
            color: var(--text-primary);
            border: none;
            padding: 14px 28px;
            border-radius: 30px;
            cursor: pointer;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: var(--transition);
            font-family: 'Fredoka', sans-serif;
            font-weight: 600;
            font-size: 16px;
        }

        .add-doodle:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }

        .type-select-container {
            margin-bottom: 15px;
        }

        .type-select {
            padding: 12px;
            width: 100%;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            margin-bottom: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
            font-family: 'Fredoka', sans-serif;
            font-size: 14px;
        }

        .type-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.3);
        }

        .add-type-btn {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            margin-top: 5px;
            font-size: 14px;
            transition: var(--transition);
            font-family: 'Fredoka', sans-serif;
        }

        .add-type-btn:hover {
            background-color: #666;
            transform: scale(1.05);
        }

        .result-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-size: 16px;
            display: flex;
            align-items: center;
        }

        .result-title::before {
            content: "";
            display: inline-block;
            width: 12px;
            height: 12px;
            margin-right: 8px;
            border-radius: 50%;
        }

        .weak-title::before {
            background-color: var(--danger);
        }

        .resist-title::before {
            background-color: var(--success);
        }

        .immune-title::before {
            background-color: var(--warning);
        }

        .result-list {
            min-height: 40px;
            padding: 15px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin-bottom: 15px;
            color: var(--text-secondary);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            transition: var(--transition);
        }

        .result-list:hover {
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .type-badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px 6px 40px;
            border-radius: 20px;
            color: white;
            font-size: 13px;
            font-weight: bold;
            white-space: nowrap;
            position: relative;
            transition: var(--transition);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .type-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .type-badge::before {
            content: "";
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.3));
        }

        .basic { background: linear-gradient(145deg, #9E9E9E, #7e7e7e); }
        .basic::before { background-image: url('logos/basic.webp'); }
        
        .fire { background: linear-gradient(145deg, #FF5722, #e64a19); }
        .fire::before { background-image: url('logos/fire.webp'); }
        
        .water { background: linear-gradient(145deg, #2196F3, #1976d2); }
        .water::before { background-image: url('logos/water.webp'); }
        
        .plant { background: linear-gradient(145deg, #4CAF50, #388e3c); }
        .plant::before { background-image: url('logos/plant.webp'); }
        
        .spark { background: linear-gradient(145deg, #FFEB3B, #fbc02d); color: #333; }
        .spark::before { background-image: url('logos/spark.webp'); }
        
        .beast { background: linear-gradient(145deg, #795548, #5d4037); }
        .beast::before { background-image: url('logos/beast.webp'); }
        
        .air { background: linear-gradient(145deg, #f0f8ff, #d0e8ff); color: #333; }
        .air::before { background-image: url('logos/air.webp'); }
        
        .insect { background: linear-gradient(145deg, #8BC34A, #689f38); }
        .insect::before { background-image: url('logos/insect.webp'); }
        
        .earth { background: linear-gradient(145deg, #795548, #5d4037); }
        .earth::before { background-image: url('logos/earth.webp'); }
        
        .mind { background: linear-gradient(145deg, #FF69B4, #e91e63); color: #fff; }
        .mind::before { background-image: url('logos/mind.webp'); }
        
        .melee { background: linear-gradient(145deg, #F44336, #d32f2f); }
        .melee::before { background-image: url('logos/melee.webp'); }
        
        .food { background: linear-gradient(145deg, #FF9800, #f57c00); }
        .food::before { background-image: url('logos/food.webp'); }
        
        .light { background: linear-gradient(145deg, #FFC107, #ffa000); color: #333; }
        .light::before { background-image: url('logos/light.webp'); }
        
        .crystal { background: linear-gradient(145deg, #00BCD4, #0097a7); }
        .crystal::before { background-image: url('logos/crystal.webp'); }
        
        .metal { background: linear-gradient(145deg, #607D8B, #455a64); }
        .metal::before { background-image: url('logos/metal.webp'); }
        
        .spirit { background: linear-gradient(145deg, #360F5A, #7b1fa2); }
        .spirit::before { background-image: url('logos/spirit.webp'); }
        
        .ice { background: linear-gradient(145deg, #00BCD4, #0097a7); }
        .ice::before { background-image: url('logos/ice.webp'); }
        
        .dark { background: linear-gradient(145deg, #433, #322); }
        .dark::before { background-image: url('logos/dark.webp'); }
        
        .poison { background: linear-gradient(145deg, #9C27B0, #7b1fa2); }
        .poison::before { background-image: url('logos/poison.webp'); }
        
        .mythic { background: linear-gradient(145deg, #FF5722, #e64a19); }
        .mythic::before { background-image: url('logos/mythic.webp'); }

        .weakness-4x {
            border: 2px solid #ff0000;
            box-shadow: 0 0 8px rgba(255, 0, 0, 0.6);
        }

        .weakness-2x {
            border: 2px solid #ff6666;
        }

        .weakness-075x {
            border: 1px solid #ff9999;
        }

        .resist-025x {
            border: 2px solid #00ff00;
            box-shadow: 0 0 8px rgba(0, 255, 0, 0.6);
        }

        .resist-05x {
            border: 2px solid #88ff88;
        }

        .immune {
            border: 2px solid #ffff00;
            box-shadow: 0 0 8px rgba(255, 255, 0, 0.6);
        }

        .team-summary {
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-top: 30px;
            box-shadow: var(--card-shadow);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .summary-box {
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            min-height: 140px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
        }

        .summary-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .summary-title {
            font-weight: bold;
            margin-bottom: 12px;
            color: var(--text-primary);
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .summary-title::before {
            content: "";
            display: inline-block;
            width: 14px;
            height: 14px;
            border-radius: 50%;
        }

        .weak-summary::before {
            background-color: var(--danger);
        }

        .resist-summary::before {
            background-color: var(--success);
        }

        .immune-summary::before {
            background-color: var(--warning);
        }

        .coverage-summary::before {
            background-color: #2196F3;
        }

        .none {
            color: #666;
            font-style: italic;
        }

        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .save-load-container {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .save-btn, .load-btn {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
            font-family: 'Fredoka', sans-serif;
        }

        .save-btn:hover, .load-btn:hover {
            background-color: #555;
            transform: translateY(-2px);
        }

        .type-count {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 2px 8px;
            margin-left: 8px;
            font-size: 12px;
        }

        @media (max-width: 1000px) {
            .team-container {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 800px) {
            .summary-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 600px) {
            .team-container {
                grid-template-columns: 1fr;
            }
            .summary-grid {
                grid-template-columns: 1fr;
            }
            .mode-toggle {
                flex-direction: column;
                align-items: center;
            }
            .mode-toggle button {
                width: 100%;
                max-width: 250px;
            }
            .save-load-container {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="header-container">
        <h1>Doodle World Type Coverage</h1>
        <div class="teambuilder-link">Check out the <a href="https://bwiffs.github.io/doodle-world-teambuilder/" target="_blank">Doodle World Teambuilder</a></div>
        
        <div class="mode-toggle">
            <button id="defensive-mode" class="active">Defensive Mode</button>
            <button id="offensive-mode">Offensive Mode</button>
        </div>

        <div class="save-load-container">
            <button class="save-btn" id="save-team">Save Team</button>
            <button class="load-btn" id="load-team">Load Team</button>
        </div>
    </div>

    <div class="team-container" id="team-container"></div>
    
    <button class="add-doodle" id="add-doodle">+ Add Doodle</button>

    <div class="team-summary">
        <h2>Team Summary</h2>
        <div class="summary-grid">
            <div class="summary-box">
                <div class="summary-title weak-summary" id="coverage-title">Team Weaknesses</div>
                <div id="team-weaknesses" class="result-list">None</div>
            </div>
            <div class="summary-box">
                <div class="summary-title resist-summary">Team Resistances</div>
                <div id="team-resistances" class="result-list">None</div>
            </div>
            <div class="summary-box">
                <div class="summary-title immune-summary">Team Immunities</div>
                <div id="team-immunities" class="result-list">None</div>
            </div>
            <div class="summary-box">
                <div class="summary-title coverage-summary" id="no-coverage-title">No Resistances</div>
                <div id="team-no-resistances" class="result-list">None</div>
            </div>
        </div>
    </div>

    <script>
        const typeChart = {
            "basic": {
                "basic": 1, "fire": 1, "water": 1, "plant": 1, "spark": 1, 
                "beast": 1, "air": 1, "insect": 1, "earth": 1, "mind": 1, 
                "melee": 2, "food": 1, "light": 1, "crystal": 1, "metal": 1, 
                "spirit": 0, "ice": 1, "dark": 1, "poison": 1, "mythic": 1
            },
            "fire": {
                "basic": 1, "fire": 0.5, "water": 2, "plant": 0.5, "spark": 1, 
                "beast": 0.5, "air": 1, "insect": 0.5, "earth": 2, "mind": 1, 
                "melee": 1, "food": 0.5, "light": 0.5, "crystal": 1, "metal": 0.5, 
                "spirit": 1, "ice": 2, "dark": 1, "poison": 1, "mythic": 1
            },
            "water": {
                "basic": 1, "fire": 0.5, "water": 0.5, "plant": 2, "spark": 2, 
                "beast": 1, "air": 1, "insect": 1, "earth": 1, "mind": 1, 
                "melee": 1, "food": 1, "light": 1, "crystal": 0.5, "metal": 0.5, 
                "spirit": 1, "ice": 0.5, "dark": 1, "poison": 2, "mythic": 1
            },
            "plant": {
                "basic": 1, "fire": 2, "water": 0.5, "plant": 0.5, "spark": 0.5, 
                "beast": 1, "air": 2, "insect": 2, "earth": 0.5, "mind": 1, 
                "melee": 1, "food": 0.5, "light": 0.5, "crystal": 1, "metal": 1, 
                "spirit": 1, "ice": 2, "dark": 1, "poison": 2, "mythic": 1
            },
            "spark": {
                "basic": 1, "fire": 1, "water": 1, "plant": 1, "spark": 0.5, 
                "beast": 0.5, "air": 0.5, "insect": 1, "earth": 2, "mind": 1, 
                "melee": 1, "food": 1, "light": 1, "crystal": 2, "metal": 0.5, 
                "spirit": 1, "ice": 1, "dark": 1, "poison": 1, "mythic": 1
            },
            "beast": {
                "basic": 1, "fire": 2, "water": 1, "plant": 1, "spark": 2, 
                "beast": 2, "air": 1, "insect": 0.5, "earth": 1, "mind": 2, 
                "melee": 1, "food": 0.5, "light": 1, "crystal": 1, "metal": 1, 
                "spirit": 1, "ice": 1, "dark": 0.5, "poison": 1, "mythic": 1
            },
            "air": {
                "basic": 1, "fire": 1, "water": 1, "plant": 0.5, "spark": 2, 
                "beast": 1, "air": 1, "insect": 0.5, "earth": 0, "mind": 1, 
                "melee": 0.5, "food": 1, "light": 1, "crystal": 1, "metal": 1, 
                "spirit": 1, "ice": 2, "dark": 1, "poison": 2, "mythic": 1
            },
            "insect": {
                "basic": 1, "fire": 2, "water": 1, "plant": 0.5, "spark": 2, 
                "beast": 2, "air": 2, "insect": 1, "earth": 0.5, "mind": 1, 
                "melee": 0.5, "food": 1, "light": 1, "crystal": 1, "metal": 1, 
                "spirit": 1, "ice": 1, "dark": 0.5, "poison": 1, "mythic": 1
            },
            "earth": {
                "basic": 1, "fire": 0.5, "water": 2, "plant": 2, "spark": 0, 
                "beast": 1, "air": 1, "insect": 1, "earth": 1, "mind": 1, 
                "melee": 1, "food": 1, "light": 1, "crystal": 0.5, "metal": 1, 
                "spirit": 1, "ice": 2, "dark": 1, "poison": 0.5, "mythic": 1
            },
            "mind": {
                "basic": 1, "fire": 1, "water": 1, "plant": 1, "spark": 1, 
                "beast": 1, "air": 1, "insect": 2, "earth": 1, "mind": 0.5, 
                "melee": 0.5, "food": 2, "light": 1, "crystal": 1, "metal": 1, 
                "spirit": 2, "ice": 1, "dark": 2, "poison": 1, "mythic": 1
            },
            "melee": {
                "basic": 1, "fire": 1, "water": 1, "plant": 1, "spark": 1, 
                "beast": 0.5, "air": 2, "insect": 0.5, "earth": 1, "mind": 2, 
                "melee": 1, "food": 2, "light": 1, "crystal": 1, "metal": 1, 
                "spirit": 1, "ice": 0.5, "dark": 1, "poison": 1, "mythic": 1
            },
            "food": {
                "basic": 1, "fire": 2, "water": 2, "plant": 1, "spark": 0.5, 
                "beast": 2, "air": 1, "insect": 2, "earth": 1, "mind": 1, 
                "melee": 1, "food": 1, "light": 0.5, "crystal": 1, "metal": 1, 
                "spirit": 1, "ice": 1, "dark": 0.5, "poison": 1, "mythic": 1
            },
            "light": {
                "basic": 1, "fire": 0.5, "water": 1, "plant": 2, "spark": 1, 
                "beast": 1, "air": 1, "insect": 1, "earth": 1, "mind": 1, 
                "melee": 1, "food": 1, "light": 0.5, "crystal": 1, "metal": 1, 
                "spirit": 0, "ice": 1, "dark": 2, "poison": 1, "mythic": 1
            },
            "crystal": {
                "basic": 1, "fire": 0.5, "water": 1, "plant": 1, "spark": 0.5, 
                "beast": 1, "air": 1, "insect": 1, "earth": 2, "mind": 2, 
                "melee": 2, "food": 1, "light": 0.5, "crystal": 1, "metal": 2, 
                "spirit": 0.5, "ice": 1, "dark": 1, "poison": 0, "mythic": 1
            },
            "metal": {
                "basic": 0.5, "fire": 2, "water": 1, "plant": 0.5, "spark": 1, 
                "beast": 0.5, "air": 0.5, "insect": 0.5, "earth": 2, "mind": 0.5, 
                "melee": 2, "food": 1, "light": 1, "crystal": 1, "metal": 0.5, 
                "spirit": 1, "ice": 0.5, "dark": 1, "poison": 0, "mythic": 1
            },
            "spirit": {
                "basic": 0, "fire": 1, "water": 1, "plant": 1, "spark": 1, 
                "beast": 1, "air": 1, "insect": 1, "earth": 1, "mind": 0.5, 
                "melee": 0, "food": 0.5, "light": 2, "crystal": 2, "metal": 1, 
                "spirit": 2, "ice": 1, "dark": 2, "poison": 0.5, "mythic": 1
            },
            "ice": {
                "basic": 1, "fire": 2, "water": 1, "plant": 1, "spark": 1, 
                "beast": 1, "air": 1, "insect": 1, "earth": 1, "mind": 1, 
                "melee": 2, "food": 1, "light": 1, "crystal": 0.5, "metal": 2, 
                "spirit": 1, "ice": 0.5, "dark": 1, "poison": 1, "mythic": 1
            },
            "dark": {
                "basic": 1, "fire": 1, "water": 1, "plant": 1, "spark": 1, 
                "beast": 2, "air": 1, "insect": 2, "earth": 1, "mind": 0, 
                "melee": 1, "food": 1, "light": 2, "crystal": 1, "metal": 1, 
                "spirit": 0.5, "ice": 1, "dark": 0.5, "poison": 1, "mythic": 1
            },
            "poison": {
                "basic": 1, "fire": 1, "water": 0.5, "plant": 1, "spark": 1, 
                "beast": 1, "air": 0.5, "insect": 0.5, "earth": 2, "mind": 2, 
                "melee": 0.5, "food": 1, "light": 1, "crystal": 1, "metal": 1, 
                "spirit": 1, "ice": 1, "dark": 1, "poison": 0.5, "mythic": 1
            },
            "mythic": {
                "basic": 0.5, "fire": 0.5, "water": 0.5, "plant": 0.5, "spark": 0.5, 
                "beast": 0.5, "air": 1, "insect": 1, "earth": 1, "mind": 1, 
                "melee": 1, "food": 1, "light": 2, "crystal": 2, "metal": 1, 
                "spirit": 1, "ice": 1, "dark": 1, "poison": 1, "mythic": 2
            }
        };

        const allTypes = Object.keys(typeChart);
        const traits = [
            "None", "Absorber-Basic", "Absorber-Earth", "Absorber-Ice", "Absorber-Spark",
            "Apex", "Arid", "Bright Lights", "Caliginous", "Chlorokinesis", "Conductor",
            "Divine Beast", "Filament", "Fire Up", "Fireproof Armour", "Hard Candy",
            "Herbivore", "Karna", "Levitate", "Melting Point", "Mushboom", "Nitelite",
            "Puffball", "Resilience", "Skyborn", "Spiteful", "Stormwater", "Tumble",
            "Unbreakable", "Water Absorb"
        ];

        let currentMode = 'defensive';
        let doodleCount = 1;

        const teamContainer = document.getElementById('team-container');
        const addDoodleBtn = document.getElementById('add-doodle');
        const defensiveModeBtn = document.getElementById('defensive-mode');
        const offensiveModeBtn = document.getElementById('offensive-mode');
        const coverageTitle = document.getElementById('coverage-title');
        const noCoverageTitle = document.getElementById('no-coverage-title');
        const saveTeamBtn = document.getElementById('save-team');
        const loadTeamBtn = document.getElementById('load-team');

        createDoodleBox();

        function createDoodleBox() {
            const doodleBox = document.createElement('div');
            doodleBox.className = 'doodle-box';
            doodleBox.dataset.index = doodleCount;
            
            const doodleHeader = document.createElement('div');
            doodleHeader.className = 'doodle-header';
            
            const doodleTitle = document.createElement('h3');
            doodleTitle.textContent = `Doodle ${doodleCount}`;
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-doodle';
            removeBtn.textContent = '×';
            removeBtn.onclick = function() {
                teamContainer.removeChild(doodleBox);
                updateTeamSummary();
            };
            
            doodleHeader.appendChild(doodleTitle);
            doodleHeader.appendChild(removeBtn);
            
            if (currentMode === 'defensive') {
                doodleBox.innerHTML = `
                    <div class="type-select-container">
                        <select class="type-select primary-type" data-doodle="${doodleCount}">
                            <option value="">Primary Type</option>
                            ${allTypes.map(type => `<option value="${type}">${type.charAt(0).toUpperCase() + type.slice(1)}</option>`).join('')}
                        </select>
                        <select class="type-select secondary-type" data-doodle="${doodleCount}">
                            <option value="">Secondary Type</option>
                            ${allTypes.map(type => `<option value="${type}">${type.charAt(0).toUpperCase() + type.slice(1)}</option>`).join('')}
                        </select>
                        <select class="type-select trait" data-doodle="${doodleCount}">
                            <option value="">Trait</option>
                            ${traits.map(trait => `<option value="${trait}">${trait}</option>`).join('')}
                        </select>
                    </div>
                    
                    <div class="result-title weak-title">Weaknesses:</div>
                    <div class="result-list weaknesses" data-doodle="${doodleCount}"><span class="none">None</span></div>
                    
                    <div class="result-title resist-title">Resistances:</div>
                    <div class="result-list resistances" data-doodle="${doodleCount}"><span class="none">None</span></div>
                    
                    <div class="result-title immune-title">Immunities:</div>
                    <div class="result-list immunities" data-doodle="${doodleCount}"><span class="none">None</span></div>
                `;
            } else {
                doodleBox.innerHTML = `
                    <div class="type-select-container" id="type-container-${doodleCount}">
                        <select class="type-select offensive-type" data-doodle="${doodleCount}">
                            <option value="">Type 1</option>
                            ${allTypes.map(type => `<option value="${type}">${type.charAt(0).toUpperCase() + type.slice(1)}</option>`).join('')}
                        </select>
                    </div>
                    <button class="add-type-btn" data-doodle="${doodleCount}">+ Add Type</button>
                    
                    <div class="result-title weak-title">Super Effective Against:</div>
                    <div class="result-list offensive" data-doodle="${doodleCount}"><span class="none">None</span></div>
                `;
            }
            
            doodleBox.prepend(doodleHeader);
            teamContainer.appendChild(doodleBox);
            doodleCount++;
            
            doodleBox.querySelectorAll('.type-select').forEach(select => {
                select.addEventListener('change', updateTypeCoverage);
            });

            if (currentMode === 'offensive') {
                doodleBox.querySelector('.add-type-btn').addEventListener('click', function() {
                    addOffensiveType(this.dataset.doodle);
                });
            }
        }

        function addOffensiveType(doodleIndex) {
            const typeContainer = document.getElementById(`type-container-${doodleIndex}`);
            const typeSelects = typeContainer.querySelectorAll('.offensive-type');
            
            if (typeSelects.length >= 4) {
                alert('Maximum of 4 types per doodle in offensive mode!');
                return;
            }
            
            const newSelect = document.createElement('select');
            newSelect.className = 'type-select offensive-type';
            newSelect.dataset.doodle = doodleIndex;
            newSelect.innerHTML = `
                <option value="">Type ${typeSelects.length + 1}</option>
                ${allTypes.map(type => `<option value="${type}">${type.charAt(0).toUpperCase() + type.slice(1)}</option>`).join('')}
            `;
            
            newSelect.addEventListener('change', updateTypeCoverage);
            typeContainer.appendChild(newSelect);
            
            const addButton = document.querySelector(`.add-type-btn[data-doodle="${doodleIndex}"]`);
            typeContainer.parentNode.insertBefore(addButton, typeContainer.nextSibling);
            
            updateTypeCoverage.call(newSelect);
        }

        addDoodleBtn.addEventListener('click', function() {
            if (teamContainer.children.length < 6) {
                createDoodleBox();
            } else {
                alert('Maximum of 6 doodles reached!');
            }
        });

        defensiveModeBtn.addEventListener('click', function() {
            if (currentMode !== 'defensive') {
                switchMode('defensive');
            }
        });

        offensiveModeBtn.addEventListener('click', function() {
            if (currentMode !== 'offensive') {
                switchMode('offensive');
            }
        });

        saveTeamBtn.addEventListener('click', saveTeam);
        loadTeamBtn.addEventListener('click', loadTeam);

        function switchMode(mode) {
            currentMode = mode;
            
            defensiveModeBtn.classList.toggle('active', mode === 'defensive');
            offensiveModeBtn.classList.toggle('active', mode === 'offensive');
            
            coverageTitle.textContent = mode === 'defensive' ? 'Team Weaknesses' : 'Team Coverage';
            noCoverageTitle.textContent = mode === 'defensive' ? 'No Resistances' : 'Not Effective Against';
            
            teamContainer.innerHTML = '';
            doodleCount = 1;
            
            createDoodleBox();
            
            updateTeamSummary();
        }

        function updateTypeCoverage() {
            const doodleIndex = this.getAttribute('data-doodle');
            const doodleBox = document.querySelector(`.doodle-box[data-index="${doodleIndex}"]`);
            
            if (currentMode === 'defensive') {
                const primaryType = doodleBox.querySelector(`.primary-type[data-doodle="${doodleIndex}"]`).value;
                const secondaryType = doodleBox.querySelector(`.secondary-type[data-doodle="${doodleIndex}"]`).value;
                const trait = doodleBox.querySelector(`.trait[data-doodle="${doodleIndex}"]`).value;

                if (!primaryType) {
                    doodleBox.querySelector(`.weaknesses[data-doodle="${doodleIndex}"]`).innerHTML = '<span class="none">None</span>';
                    doodleBox.querySelector(`.resistances[data-doodle="${doodleIndex}"]`).innerHTML = '<span class="none">None</span>';
                    doodleBox.querySelector(`.immunities[data-doodle="${doodleIndex}"]`).innerHTML = '<span class="none">None</span>';
                    updateTeamSummary();
                    return;
                }

                const weaknesses = calculateWeaknesses(primaryType, secondaryType, trait);
                const resistances = calculateResistances(primaryType, secondaryType, trait);
                const immunities = calculateImmunities(primaryType, secondaryType, trait);

                updateResultList(`.weaknesses[data-doodle="${doodleIndex}"]`, weaknesses, 'weakness');
                updateResultList(`.resistances[data-doodle="${doodleIndex}"]`, resistances, 'resist');
                updateResultList(`.immunities[data-doodle="${doodleIndex}"]`, immunities);
            } else {
                const typeSelects = doodleBox.querySelectorAll('.offensive-type');
                const selectedTypes = Array.from(typeSelects)
                    .map(select => select.value)
                    .filter(type => type !== "");
                
                if (selectedTypes.length === 0) {
                    doodleBox.querySelector(`.offensive[data-doodle="${doodleIndex}"]`).innerHTML = '<span class="none">None</span>';
                    updateTeamSummary();
                    return;
                }

                const offensiveCoverage = calculateOffensiveCoverage(selectedTypes);
                updateResultList(`.offensive[data-doodle="${doodleIndex}"]`, offensiveCoverage, 'offensive');
            }

            updateTeamSummary();
        }

        function calculateOffensiveCoverage(types) {
            const results = {};
            
            types.forEach(type => {
                allTypes.forEach(defendingType => {
                    const effectiveness = typeChart[defendingType][type];
                    
                    if (effectiveness > 1) {
                        if (!results[defendingType] || effectiveness > results[defendingType].effectiveness) {
                            results[defendingType] = {
                                effectiveness: effectiveness,
                                attackingType: type
                            };
                        }
                    }
                });
            });
            
            const formattedResults = {};
            Object.entries(results).forEach(([defendingType, data]) => {
                if (data.effectiveness >= 3.5) {
                    formattedResults[defendingType] = 'weak-4x';
                } else if (data.effectiveness > 1.5) {
                    formattedResults[defendingType] = 'weak-2x';
                } else if (data.effectiveness > 1.1) {
                    formattedResults[defendingType] = 'weak-075x';
                }
            });
            
            return formattedResults;
        }

        function calculateNotEffectiveTypes(types) {
            const notEffective = {};
            
            allTypes.forEach(defendingType => {
                let isEffective = false;
                
                types.forEach(type => {
                    const effectiveness = typeChart[defendingType][type];
                    if (effectiveness > 1) {
                        isEffective = true;
                    }
                });
                
                if (!isEffective) {
                    let resistanceLevel = 1;
                    types.forEach(type => {
                        const effectiveness = typeChart[defendingType][type];
                        if (effectiveness < 1) {
                            resistanceLevel *= effectiveness;
                        }
                    });
                    
                    if (resistanceLevel < 1) {
                        if (resistanceLevel <= 0.26) {
                            notEffective[defendingType] = 'resist-025x';
                        } else {
                            notEffective[defendingType] = 'resist-05x';
                        }
                    } else {
                        notEffective[defendingType] = 'neutral';
                    }
                }
            });
            
            return notEffective;
        }


        function applyTraitEffects(primary, secondary, trait, attackingType, effectiveness) {
            if (trait === "None") return effectiveness;

            if ((trait === "Absorber-Basic" && attackingType === "basic") ||
                (trait === "Absorber-Earth" && attackingType === "earth") ||
                (trait === "Absorber-Ice" && attackingType === "ice") ||
                (trait === "Absorber-Spark" && attackingType === "spark")) {
                return 0;
            }

            if (trait === "Fireproof Armour" && attackingType === "fire") {
                if (effectiveness > 3.5) return 2;
                if (effectiveness > 1.5) return 1;
                if (effectiveness > 0.9 && effectiveness < 1.1) return 0.5;
                if (effectiveness < 0.6) return 0.25;
            }

            if ((trait === "Arid" && attackingType === "water") ||
                (trait === "Bright Lights" && attackingType === "dark") ||
                (trait === "Caliginous" && attackingType === "light") ||
                (trait === "Chlorokinesis" && attackingType === "plant") ||
                (trait === "Conductor" && attackingType === "spark") ||
                (trait === "Divine Beast" && attackingType === "beast") ||
                (trait === "Filament" && attackingType === "spark") ||
                (trait === "Fire Up" && attackingType === "fire") ||
                (trait === "Hard Candy" && attackingType === "fire") ||
                (trait === "Herbivore" && attackingType === "plant") ||
                (trait === "Levitate" && attackingType === "earth") ||
                (trait === "Melting Point" && attackingType === "ice") ||
                (trait === "Skyborn" && attackingType === "air") ||
                (trait === "Stormwater" && attackingType === "water") ||
                (trait === "Water Absorb" && attackingType === "water")) {
                return 0;
            }

            if (trait === "Karna" && attackingType === "earth") {
                return effectiveness * 0.5;
            }

            if (trait === "Nitelite" && attackingType === "dark") {
                return effectiveness * 0.5;
            }

            if (trait === "Tumble" && attackingType === "melee") {
                return effectiveness * 0.5;
            }

            if ((trait === "Mushboom" || trait === "Puffball") && attackingType === "air") {
                return effectiveness * 0.25;
            }

            if (trait === "Apex" && (primary === "beast" || secondary === "beast")) {
                if (typeChart["beast"][attackingType] !== 1) {
                    return effectiveness / typeChart["beast"][attackingType];
                }
            }

            if (trait === "Resilience" && effectiveness < 0.5) {
                return effectiveness * 0.25;
            }

            if (trait === "Spiteful" && effectiveness !== 0) {
                return 1 / effectiveness;
            }

            if (trait === "Unbreakable" && effectiveness > 1) {
                return effectiveness * 0.75;
            }

            return effectiveness;
        }

        function calculateWeaknesses(primary, secondary, trait) {
            const results = {};

            allTypes.forEach(attackingType => {
                const primaryEffect = typeChart[primary][attackingType];
                const secondaryEffect = secondary ? typeChart[secondary][attackingType] : 1;
                let combinedEffect = primaryEffect * secondaryEffect;

                combinedEffect = applyTraitEffects(primary, secondary, trait, attackingType, combinedEffect);

                if (combinedEffect > 1) {
                    if (combinedEffect >= 3.5) { 
                        results[attackingType] = 'weak-4x';
                    } else if (combinedEffect > 1.5) {
                        results[attackingType] = 'weak-2x';
                    } else if (combinedEffect > 1.1) {
                        results[attackingType] = 'weak-075x';
                    }
                }
            });

            return results;
        }

        function calculateResistances(primary, secondary, trait) {
            const results = {};

            allTypes.forEach(attackingType => {
                const primaryEffect = typeChart[primary][attackingType];
                const secondaryEffect = secondary ? typeChart[secondary][attackingType] : 1;
                let combinedEffect = primaryEffect * secondaryEffect;

                combinedEffect = applyTraitEffects(primary, secondary, trait, attackingType, combinedEffect);

                if (combinedEffect < 1 && combinedEffect > 0) {
                    if (combinedEffect <= 0.26) { 
                        results[attackingType] = 'resist-025x';
                    } else if (combinedEffect < 0.9) {
                        results[attackingType] = 'resist-05x';
                    }
                }
            });

            return results;
        }

        function calculateImmunities(primary, secondary, trait) {
            const results = {};

            allTypes.forEach(attackingType => {
                const primaryEffect = typeChart[primary][attackingType];
                const secondaryEffect = secondary ? typeChart[secondary][attackingType] : 1;
                let combinedEffect = primaryEffect * secondaryEffect;

                combinedEffect = applyTraitEffects(primary, secondary, trait, attackingType, combinedEffect);

                if (Math.abs(combinedEffect) < 0.1) { 
                    results[attackingType] = 'immune';
                }
            });

            return results;
        }

        function updateResultList(selector, typeEffects, effectType = '') {
            const element = document.querySelector(selector);

            if (!element) return;
            
            if (Object.keys(typeEffects).length === 0) {
                element.innerHTML = '<span class="none">None</span>';
                return;
            }

            element.innerHTML = '';

            const typesArray = Object.entries(typeEffects)
                .sort((a, b) => {
                    if (a[1] !== b[1]) {
                        return a[1].localeCompare(b[1]);
                    }
                    return a[0].localeCompare(b[0]);
                });

            typesArray.forEach(([type, effect]) => {
                const badge = document.createElement('span');
                badge.className = `type-badge ${type}`;

                if (effectType) {
                    badge.classList.add(effect);
                }

                let text = type.charAt(0).toUpperCase() + type.slice(1);
                if (effect === 'weak-4x') text += ' (4×)';
                else if (effect === 'weak-2x') text += ' (2×)';
                else if (effect === 'weak-075x') text += ' (1.5×)';
                else if (effect === 'resist-025x') text += ' (¼×)';
                else if (effect === 'resist-05x') text += ' (½×)';
                if (effect === 'immune') badge.classList.add('immune');

                badge.textContent = text;
                element.appendChild(badge);
            });
        }

        function updateTeamSummary() {
            if (currentMode === 'defensive') {
                updateDefensiveTeamSummary();
            } else {
                updateOffensiveTeamSummary();
            }
        }

        function updateDefensiveTeamSummary() {
            const allWeaknesses = {};
            const allResistances = {};
            const allImmunities = new Set();

            document.querySelectorAll('.doodle-box').forEach((box) => {
                const primary = box.querySelector('.primary-type')?.value;
                const secondary = box.querySelector('.secondary-type')?.value;
                const trait = box.querySelector('.trait')?.value;

                if (primary) {
                    const weaknesses = calculateWeaknesses(primary, secondary, trait);
                    Object.entries(weaknesses).forEach(([type, effect]) => {
                        if (!allWeaknesses[type]) allWeaknesses[type] = { count: 0, maxEffect: effect };
                        allWeaknesses[type].count++;
                        if (effect === 'weak-4x') allWeaknesses[type].maxEffect = 'weak-4x';
                        else if (allWeaknesses[type].maxEffect !== 'weak-4x' && effect === 'weak-2x') {
                            allWeaknesses[type].maxEffect = 'weak-2x';
                        }
                        else if (allWeaknesses[type].maxEffect !== 'weak-4x' && 
                                 allWeaknesses[type].maxEffect !== 'weak-2x' && 
                                 effect === 'weak-075x') {
                            allWeaknesses[type].maxEffect = 'weak-075x';
                        }
                    });

                    const resistances = calculateResistances(primary, secondary, trait);
                    Object.entries(resistances).forEach(([type, effect]) => {
                        if (!allResistances[type]) allResistances[type] = { count: 0, maxEffect: effect };
                        allResistances[type].count++;
                        if (effect === 'resist-025x') allResistances[type].maxEffect = 'resist-025x';
                        else if (allResistances[type].maxEffect !== 'resist-025x' && effect === 'resist-05x') {
                            allResistances[type].maxEffect = 'resist-05x';
                        }
                    });

                    const immunities = calculateImmunities(primary, secondary, trait);
                    Object.keys(immunities).forEach(type => {
                        allImmunities.add(type);
                    });
                }
            });

            updateTeamResultList('#team-weaknesses', allWeaknesses, 'weakness');
            updateTeamResultList('#team-resistances', allResistances, 'resist');
            updateTeamResultList('#team-immunities', allImmunities);

            const noResistances = allTypes.filter(type => {
                return !allResistances[type] && !allImmunities.has(type);
            });
            updateTeamResultList('#team-no-resistances', noResistances);
        }

        function updateOffensiveTeamSummary() {
            const allCoverage = {};
            const allTeamTypes = [];
            
            document.querySelectorAll('.doodle-box').forEach((box) => {
                const typeSelects = box.querySelectorAll('.offensive-type');
                const selectedTypes = Array.from(typeSelects)
                    .map(select => select.value)
                    .filter(type => type !== "");
                
                if (selectedTypes.length > 0) {
                    allTeamTypes.push(...selectedTypes);
                    const coverage = calculateOffensiveCoverage(selectedTypes);
                    Object.keys(coverage).forEach(type => {
                        if (!allCoverage[type]) allCoverage[type] = 0;
                        allCoverage[type]++;
                    });
                }
            });
            
            const coverageData = {};
            Object.entries(allCoverage).forEach(([type, count]) => {
                coverageData[type] = { count, maxEffect: 'weak-2x' };
            });
            
            updateTeamResultList('#team-weaknesses', coverageData, 'weakness');
            
            const notEffective = calculateNotEffectiveTypes(allTeamTypes);
            updateTeamResultList('#team-no-resistances', notEffective, 'resist');
            
            document.getElementById('team-resistances').innerHTML = '<span class="none">N/A in offensive mode</span>';
            document.getElementById('team-immunities').innerHTML = '<span class="none">N/A in offensive mode</span>';
        }

        function updateTeamResultList(selector, typeData, effectType = '') {
            const element = document.querySelector(selector);

            if ((effectType === 'weakness' || effectType === 'resist') ? 
                Object.keys(typeData).length === 0 : typeData.size === 0) {
                element.innerHTML = '<span class="none">None</span>';
                return;
            }

            element.innerHTML = '';

            let typesArray;
            if (effectType === 'weakness' || effectType === 'resist') {
                typesArray = Object.entries(typeData)
                    .map(([type, data]) => ({
                        type,
                        count: typeof data === 'object' ? data.count : 0,
                        effect: typeof data === 'object' ? data.maxEffect : data
                    }))
                    .sort((a, b) => {
                        if (b.count !== a.count) return b.count - a.count;
                        if (b.effect !== a.effect) return b.effect.localeCompare(a.effect);
                        return a.type.localeCompare(b.type);
                    });
            } else {
                typesArray = Array.isArray(typeData) ? 
                    typeData.sort((a, b) => a.localeCompare(b)) : 
                    Array.from(typeData).sort((a, b) => a.localeCompare(b));
            }

            typesArray.forEach(type => {
                const badge = document.createElement('span');
                let typeName = typeof type === 'object' ? type.type : type;
                let effect = typeof type === 'object' ? type.effect : '';

                badge.className = `type-badge ${typeName}`;

                if (effectType) {
                    badge.classList.add(effect);
                }

                let text = typeName.charAt(0).toUpperCase() + typeName.slice(1);
                if (effectType === 'weakness' || effectType === 'resist') {
                    if (typeof type === 'object' && type.count > 0) {
                        text += ` (${type.count})`;
                    }
                    if (effect === 'weak-4x') text += ' 4×';
                    else if (effect === 'weak-2x') text += ' 2×';
                    else if (effect === 'weak-075x') text += ' 1.5×';
                    else if (effect === 'resist-025x') text += ' ¼×';
                    else if (effect === 'resist-05x') text += ' ½×';
                }

                badge.textContent = text;
                element.appendChild(badge);
            });
        }


        function saveTeam() {
            const teamData = {
                mode: currentMode,
                doodles: []
            };

            document.querySelectorAll('.doodle-box').forEach((box, index) => {
                const doodleIndex = box.dataset.index;
                const doodleData = { index: doodleIndex };
                
                if (currentMode === 'defensive') {
                    doodleData.primaryType = box.querySelector(`.primary-type[data-doodle="${doodleIndex}"]`).value;
                    doodleData.secondaryType = box.querySelector(`.secondary-type[data-doodle="${doodleIndex}"]`).value;
                    doodleData.trait = box.querySelector(`.trait[data-doodle="${doodleIndex}"]`).value;
                } else {
                    const typeSelects = box.querySelectorAll('.offensive-type');
                    doodleData.types = Array.from(typeSelects).map(select => select.value).filter(val => val);
                }
                
                teamData.doodles.push(doodleData);
            });

            localStorage.setItem('doodleTeam', JSON.stringify(teamData));
            alert('Team saved successfully!');
        }

        function loadTeam() {
            const savedTeam = localStorage.getItem('doodleTeam');
            if (!savedTeam) {
                alert('No saved team found!');
                return;
            }

            const teamData = JSON.parse(savedTeam);
            
            if (teamData.mode !== currentMode) {
                switchMode(teamData.mode);
                setTimeout(() => {
                    loadDoodles(teamData);
                }, 100);
            } else {
                loadDoodles(teamData);
            }
        }

        function loadDoodles(teamData) {
            teamContainer.innerHTML = '';
            doodleCount = 1;
            
            teamData.doodles.forEach((doodleData, index) => {
                createDoodleBox();
                const doodleBox = document.querySelector(`.doodle-box[data-index="${doodleCount - 1}"]`);
                
                if (teamData.mode === 'defensive') {
                    if (doodleData.primaryType) {
                        doodleBox.querySelector(`.primary-type[data-doodle="${doodleCount - 1}"]`).value = doodleData.primaryType;
                    }
                    if (doodleData.secondaryType) {
                        doodleBox.querySelector(`.secondary-type[data-doodle="${doodleCount - 1}"]`).value = doodleData.secondaryType;
                    }
                    if (doodleData.trait) {
                        doodleBox.querySelector(`.trait[data-doodle="${doodleCount - 1}"]`).value = doodleData.trait;
                    }
                } else {
                    if (doodleData.types && doodleData.types.length > 0) {
                        const typeContainer = doodleBox.querySelector(`#type-container-${doodleCount - 1}`);
                        const existingSelects = typeContainer.querySelectorAll('.offensive-type');
                        for (let i = 1; i < existingSelects.length; i++) {
                            typeContainer.removeChild(existingSelects[i]);
                        }
                        
                        existingSelects[0].value = doodleData.types[0];
                        
                        for (let i = 1; i < doodleData.types.length; i++) {
                            addOffensiveType(doodleCount - 1);
                            const newSelect = typeContainer.querySelectorAll('.offensive-type')[i];
                            newSelect.value = doodleData.types[i];
                        }
                    }
                }
                
                if (doodleBox.querySelector('.type-select')) {
                    doodleBox.querySelector('.type-select').dispatchEvent(new Event('change'));
                }
            });
            
            updateTeamSummary();
            alert('Team loaded successfully!');
        }
    </script>
</body>
</html>

